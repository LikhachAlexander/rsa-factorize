from util import factorize, modinv, int_to_str

N = 180316045077070643576730041842075312724684105152194871936433279513449281699423768495300361191768650686626404938832850303413611061444777379620913797804023486559862614336491499207951172992894879080722877738260576768374514832770641708584292487263791709169148934661897076210837683691576894829187942771980300323523
c = 18664779105067277287061616712957593613023683210046209065056159685407532276423477565268548760040124276243787141203292573321675910162919578418219417955528337850227806335080637396373660098298524310034858426147805641751408707900990046821134427428543339927048143734162901556731291397727523817825959182727657236942

# factorize N
p, q = factorize(N)
print("p =", p)
print("q =", q)


# calculaet private key exponent
phi = (p - 1) * (q - 1)
e = 65537
d = modinv(e, phi)
print("Calculated d =", d)

# decode c as m = c ^ d
m = pow(c, d, N)
# interger to str
print(int_to_str(m))
